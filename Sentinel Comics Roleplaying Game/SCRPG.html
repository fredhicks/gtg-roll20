<script type="text/worker">

var uniqueids = {};

// set up the health ranges

const yellowmax = [];
const redmax = [];
yellowmax[40] = 29; redmax[40] = 14;
yellowmax[39] = 29; redmax[39] = 14;
yellowmax[38] = 28; redmax[38] = 13;
yellowmax[37] = 28; redmax[37] = 13;
yellowmax[36] = 27; redmax[36] = 13;
yellowmax[35] = 26; redmax[35] = 12;
yellowmax[34] = 25; redmax[34] = 12;
yellowmax[33] = 25; redmax[33] = 12;
yellowmax[32] = 24; redmax[32] = 11;
yellowmax[31] = 23; redmax[31] = 11;
yellowmax[30] = 22; redmax[30] = 11;
yellowmax[29] = 22; redmax[29] = 10;
yellowmax[28] = 21; redmax[28] = 10;
yellowmax[27] = 20; redmax[27] = 10;
yellowmax[26] = 20; redmax[26] = 9;
yellowmax[25] = 19; redmax[25] = 9;
yellowmax[24] = 18; redmax[24] = 9;
yellowmax[23] = 18; redmax[23] = 8;
yellowmax[22] = 17; redmax[22] = 8;
yellowmax[21] = 16; redmax[21] = 8;
yellowmax[20] = 15; redmax[20] = 7;
yellowmax[19] = 14; redmax[19] = 7;
yellowmax[18] = 14; redmax[18] = 7;
yellowmax[17] = 13; redmax[17] = 6;

var generateActuallyUniqueRowID = function() {
	var generated = generateRowID();
	while ( uniqueids[generated] === true ) {
		log("generateActuallyUniqueRowID: " + generated + " is not a unique ID, trying again.");
		generated = generateRowID();
	}
	// log("generateActuallyUniqueRowID: " + generated + " verified as unique, returning.");
	uniqueids[generated] = true;
	return generated;
};

var rollD = function(d) {
	var result = Math.floor( ( Math.random() * d ) + 1) ;
	// log("d"+d+" = "+result);
	return({
		"die": d,
		"result": result
	});
};

var roll3D = function(p,q,s) {
	log(p);
	var pow = rollD(p);
	var qua = rollD(q);
	var sta = rollD(s);
	log(pow); log(qua); log(sta);
	var spread = [ pow.result, qua.result, sta.result ];
	spread.sort();
	var min = spread[0];
	var mid = spread[1];
	var max = spread[2];
	return({
		"power": pow,
		"quality": qua,
		"status": sta,
		"min": min,
		"mid": mid,
		"max": max
	});
};

on("clicked:roll3pool", function() {
	getAttrs( [ "selected_die_status", "selected_die_power", "selected_die_quality" ], function(a) {
		log(a);
		var results = roll3D(
			a["selected_die_power"],
			a["selected_die_quality"],
			a["selected_die_status"]
		);
		var rtext = `&{template:3pool} {{name=@{character_name}}} {{powername=@{selected_die_power_text}}} {{powerdie=${a.selected_die_power}}} {{powerresult=${results.power.result}}} {{qualityname=@{selected_die_quality_text}}} {{qualitydie=${a.selected_die_quality}}} {{qualityresult=${results.quality.result}}} {{statusname=@{selected_die_status_text}}} {{statusdie=${a.selected_die_status}}} {{statusresult=${results.status.result}}} {{min=${results.min}}} {{mid=${results.mid}}} {{max=${results.max}}}`;
		startRoll(rtext, function(roll) {
			finishRoll( roll.rollId );
		});
	});
});

on("clicked:rolldie", function(e) {
	log(e);
	var mode = e.htmlAttributes.value;
	if ( mode === "quality" || mode === "power" || mode === "status" ) {
		var tf = `selected_die_${mode}_text`; var df = `selected_die_${mode}`;
		getAttrs([ tf, df ], function(a) {
			var die = a[df];
			var result = rollD(die);
			var rtext = `&{template:simple} {{name=@{character_name}}} {{die=${die}}} {{diename=@{${tf}}}} {{dieresult=${result.result}}}`
			startRoll(rtext, function(roll) {
				finishRoll( roll.rollId );
			});			
		});
	} else {
		// going to hope we safely assume this is a number: 4,6,8,10,12
		var die = mode;
		var result = rollD(die);
		var rtext = `&{template:simple} {{name=@{character_name}}} {{die=${die}}} {{diename=die}} {{dieresult=${result.result}}}`
		startRoll(rtext, function(roll) {
			finishRoll( roll.rollId );
		});
	}
});

on("change:hero_die_selector_status_green", function() {
	getAttrs(["hero_die_selector_status_green"], function(sval) {
		var a = {};
		if ( 
			typeof sval["hero_die_selector_status_green"] !== "undefined" 
			&& sval["hero_die_selector_status_green"] === "1" 
		) {
			a["hero_die_selector_status_yellow"] = "";
			a["hero_die_selector_status_red"] = "";
			setAttrs(a);
		}
	});
});

on("change:hero_die_selector_status_yellow", function() {
	getAttrs(["hero_die_selector_status_yellow"], function(sval) {
		var a = {};
		if ( 
			typeof sval["hero_die_selector_status_yellow"] !== "undefined" 
			&& sval["hero_die_selector_status_yellow"] === "1" 
		) {
			a["hero_die_selector_status_green"] = "";
			a["hero_die_selector_status_red"] = "";
			setAttrs(a);
		}
	});
});

on("change:hero_die_selector_status_red", function() {
	getAttrs(["hero_die_selector_status_red"], function(sval) {
		var a = {};
		if ( 
			typeof sval["hero_die_selector_status_red"] !== "undefined" 
			&& sval["hero_die_selector_status_red"] === "1" 
		) {
			a["hero_die_selector_status_green"] = "";
			a["hero_die_selector_status_yellow"] = "";
			setAttrs(a);
		}
	});
});

on("change:repeating_heroqualities:hero_die_selector", function(e) {
	// var rowid = (e.sourceAttribute).slice(0,-17); // Strips off the 'hero_die_selector';
	var selid = e.sourceAttribute;
	getAttrs([selid], function(dval) {
		var a = {};
		if ( 
			typeof dval[selid] !== "undefined" 
			&& dval[selid] === "1" 
		) {
			getSectionIDs("repeating_heroqualities", function(d) {
				for ( var i=0; i < d.length; i++ ) {
					var thisid = "repeating_heroqualities_" + d[i] + "_hero_die_selector";
					if ( thisid !== selid ) {
						// Then it should not be selected, because it's 
						// not the one that just GOT selected.
						//
						// Will eventually need to override this for
						// support of Divided characters that roll two Q
						// or two P instead of 1P&1Q, but let's cross that
						// bridge when we come to it.
						a[thisid] = "";
					}
				}
				setAttrs(a);
			});
		}
	});
});

on("change:repeating_heropowers:hero_die_selector", function(e) {
	// var rowid = (e.sourceAttribute).slice(0,-17); // Strips off the 'hero_die_selector';
	var selid = e.sourceAttribute;
	getAttrs([selid], function(dval) {
		var a = {};
		if ( 
			typeof dval[selid] !== "undefined" 
			&& dval[selid] === "1" 
		) {
			getSectionIDs("repeating_heropowers", function(d) {
				for ( var i=0; i < d.length; i++ ) {
					var thisid = "repeating_heropowers_" + d[i] + "_hero_die_selector";
					if ( thisid !== selid ) {
						// Then it should not be selected, because it's 
						// not the one that just GOT selected.
						//
						// Will eventually need to override this for
						// support of Divided characters that roll two Q
						// or two P instead of 1P&1Q, but let's cross that
						// bridge when we come to it.
						a[thisid] = "";
					}
				}
				setAttrs(a);
			});
		}
	});
});

on("sheet:opened change:repeating_heropowers change:repeating_heroqualities change:hero_die_selector_status_green change:hero_die_selector_status_yellow change:hero_die_selector_status_red", function() {
	var alist = [ "hero_die_selector_status_green", "hero_die_selector_status_yellow", "hero_die_selector_status_red" ];
	getSectionIDs("repeating_heroqualities", function(q) {
		for ( var i=0; i < q.length; i++ ) {
			var thisid = "repeating_heroqualities_" + q[i] + "_hero_die_selector";
			alist[i+3] = thisid;
		}
		getSectionIDs("repeating_heropowers", function(p) {
			for ( var i=0; i < p.length; i++ ) {
				var thisid = "repeating_heropowers_" + p[i] + "_hero_die_selector";
				alist[i+q.length+3] = thisid;
			}
			getAttrs(alist, function(dice) {
				var powerprefix = ""; var powername = ""; var powerdie = "";
				var qualityprefix = ""; var qualityname = ""; var qualitydie = "";
				var statusfield = ""; var statusname = ""; var statusdie = "";
				for ( var i=0; i < p.length; i++ ) {
					var thisid = "repeating_heropowers_" + p[i] + "_hero_die_selector";
					if ( dice[thisid] === "1" ) {
						powerprefix = "repeating_heropowers_" + p[i] + "_";
						break;
					}
				}
				for ( var i=0; i < q.length; i++ ) {
					var thisid = "repeating_heroqualities_" + q[i] + "_hero_die_selector";
					if ( dice[thisid] === "1" ) {
						qualityprefix = "repeating_heroqualities_" + q[i] + "_";
						break;
					}
				}
				if ( dice["hero_die_selector_status_green"] === "1" ) {
					statusname = "Green";
					statusfield = "hero_status_die_green";
				} else if ( dice["hero_die_selector_status_yellow"] === "1") {
					statusname = "Yellow";
					statusfield = "hero_status_die_yellow";
				} else if ( dice["hero_die_selector_status_red"] === "1") {
					statusname = "Red";
					statusfield = "hero_status_die_red";
				}

				var vlist = [];
				if (statusfield !== "") {
					vlist[vlist.length] = statusfield;
				}
				if (powerprefix !== "") {
					vlist[vlist.length] = powerprefix + "name";
					vlist[vlist.length] = powerprefix + "die";
				}
				if (qualityprefix !== "") {
					vlist[vlist.length] = qualityprefix + "name";
					vlist[vlist.length] = qualityprefix + "die";
				}
				if ( vlist.length > 0 ) {
					getAttrs(vlist, function(v) {
						pat = {};
						if (powerprefix !== "") {
							pat["selected_die_power"] = v[`${powerprefix}die`]
							pat["selected_die_power_text"] = v[`${powerprefix}name`];
						} else {
							pat["selected_die_power"] = "4";
							pat["selected_die_power_text"] = "No Power";
						}
						pat["selected_die_pool_text"] = pat["selected_die_power_text"];
						if (qualityprefix !== "") {
							pat["selected_die_quality"] = v[`${qualityprefix}die`]
							pat["selected_die_quality_text"] = v[`${qualityprefix}name`];
						} else {
							pat["selected_die_quality"] = "4";
							pat["selected_die_quality_text"] = "No Quality";
						}
						pat["selected_die_pool_text"] = pat["selected_die_pool_text"] + ", " + pat["selected_die_quality_text"];
						if (statusfield !== "") {
							pat["selected_die_status"] = v[statusfield];
							pat["selected_die_status_text"] = statusname;
						} else {
							pat["selected_die_status"] = "4";
							pat["selected_die_status_text"] = "No Status";
						}
						pat["selected_die_pool_text"] = pat["selected_die_pool_text"] + ", " + pat["selected_die_status_text"];
						setAttrs(pat);
					});
				} else {
					setAttrs({
						"selected_die_pool_text": "No Power, No Quality, No Status",
						"selected_die_status_text": "No Status",
						"selected_die_power_text": "No Power",
						"selected_die_quality_text": "No Quality",
						"selected_die_status": "4",
						"selected_die_power": "4",
						"selected_die_quality": "4"
					});
				}
			});
		});		
	});
});

on("change:health_max", function() {
	log("change:health_max");
	getAttrs(
		["health_max","health","health_yellow_top","health_yellow_bottom"],
		function(a) {
			var max = Number(a.health_max);
			if ( typeof max !== "undefined" ) {
				var hupdate = {
					// "health": max,
					"health_green_bottom": yellowmax[max]+1,
					"health_yellow_top": yellowmax[max],
					"health_yellow_bottom": redmax[max]+1,
					"health_red_top": redmax[max],
				};
				setAttrs(hupdate);
			}
		}
	);
});

on("change:health sheet:opened change:scene_status", function() {
	log("change:health");
	getAttrs(
		["health_max","health","health_yellow_top","health_red_top", "hero_die_selector_status_green", "hero_die_selector_status_yellow", "hero_die_selector_status_red", "scene_status" ],
		function(a) {
			var health = Number(a.health);
			var yellow = Number(a.health_yellow_top);
			var red = Number(a.health_red_top);
			var scene = a.scene_status;
			if ( typeof scene === "undefined" ) {
				scene = "green";
			}
			var supdate = {};
			if ( 
				typeof health !== "undefined" && 
				typeof yellow !== "undefined" && 
				typeof red !== "undefined" 
			) {

				if ( health <= 0 ) { supdate.healthcolor = "black"; }
				else if ( health <= red ) { supdate.healthcolor = "red"; }
				else if ( health <= yellow ) { supdate.healthcolor = "yellow"; }
				else { supdate.healthcolor = "green"; }

				if ( health <= red || scene === "red" ) {
					// then consider selecting red - even if the scene is red
					supdate.hero_die_selector_status_red = "1";
					supdate.hero_die_selector_status_yellow = "";
					supdate.hero_die_selector_status_green = "";
				} else if ( ( health <= yellow || scene === "yellow" ) && scene !== "red" ) {
					// then consider selecting yellow
					supdate.hero_die_selector_status_red = "";
					supdate.hero_die_selector_status_yellow = "1";
					supdate.hero_die_selector_status_green = "";
				} else {
					// then consider selecting green
					supdate.hero_die_selector_status_red = "";
					supdate.hero_die_selector_status_yellow = "";
					supdate.hero_die_selector_status_green = "1";
				}

				setAttrs(supdate);
			}
		}
	);
});

on("clicked:addbonus", function() {
	getAttrs(["addbonus_value", "addbonus_persistent", "addbonus_exclusive", "addbonus_tag"], function(a) {
		var id = generateActuallyUniqueRowID();
		var prefix = `repeating_bonuses_${id}_`;
		var bupdate = {
			"addbonus_value": 1,
			"addbonus_persistent": 0,
			"addbonus_exclusive": 0,
			"addbonus_tag": ""
		};
		bupdate[`${prefix}value`] = 1;
		bupdate[`${prefix}persistent`] = 0;
		bupdate[`${prefix}exclusive`] = 0;
		bupdate[`${prefix}tag`] = "";
		if ( typeof a.addbonus_value !== "undefined" ) {
			bupdate[`${prefix}value`] = a.addbonus_value;
		}
		if ( typeof a.addbonus_persistent !== "undefined" && a.addbonus_persistent === "1" ) {
			bupdate[`${prefix}persistent`] = a.addbonus_persistent;
		}
		if ( typeof a.addbonus_exclusive !== "undefined" && a.addbonus_exclusive === "1" ) {
			bupdate[`${prefix}exclusive`] = a.addbonus_exclusive;
		}
		if ( typeof a.addbonus_tag !== "undefined" ) {
			bupdate[`${prefix}tag`] = a.addbonus_tag;
		}
		log(bupdate);
		setAttrs(bupdate);
	});
});

on("clicked:addpenalty", function() {
	getAttrs(["addpenalty_value", "addpenalty_persistent", "addpenalty_exclusive", "addpenalty_tag"], function(a) {
		var id = generateActuallyUniqueRowID();
		var prefix = `repeating_penalties_${id}_`;
		var bupdate = {
			"addpenalty_value": 1,
			"addpenalty_persistent": 0,
			"addpenalty_exclusive": 0,
			"addpenalty_tag": ""
		};
		bupdate[`${prefix}value`] = 1;
		bupdate[`${prefix}persistent`] = 0;
		bupdate[`${prefix}exclusive`] = 0;
		bupdate[`${prefix}tag`] = "";
		if ( typeof a.addpenalty_value !== "undefined" ) {
			bupdate[`${prefix}value`] = a.addpenalty_value;
		}
		if ( typeof a.addpenalty_persistent !== "undefined" && a.addpenalty_persistent === "1" ) {
			bupdate[`${prefix}persistent`] = a.addpenalty_persistent;
		}
		if ( typeof a.addpenalty_exclusive !== "undefined" && a.addpenalty_exclusive === "1" ) {
			bupdate[`${prefix}exclusive`] = a.addpenalty_exclusive;
		}
		if ( typeof a.addpenalty_tag !== "undefined" ) {
			bupdate[`${prefix}tag`] = a.addpenalty_tag;
		}
		log(bupdate);
		setAttrs(bupdate);
	});
});

on("clicked:repeating_bonuses:dismiss clicked:repeating_penalties:dismiss", function(e) {
	var rowid = (e.sourceAttribute).slice(0,-8); // Strips off the '_dismiss'
	getAttrs([rowid+"_hpf"], function(a) {
		var hpf = a[rowid+"_hpf"];
		if ( typeof hpf !== "undefined" && hpf !== "" ) {
			var s = {}; s[hpf] = "0";
			setAttrs(s);
		}
		removeRepeatingRow(rowid);
	});
});

on("clicked:repeating_bonuses:decrease clicked:repeating_penalties:decrease", function(e) {
	var prefix = (e.sourceAttribute).slice(0,-8); // Strips off the 'decrease'
	var id = `${prefix}value`;
	getAttrs([id], function(a) {
		var value = a[id];
		if ( typeof value !== "undefined" && Number(value) > 1  ) { // Only decrease numbers above one
			value = Number(value) - 1;
			var s = {};
			s[id] = value;
			setAttrs(s);
		}
	});
});

on("clicked:repeating_bonuses:increase clicked:repeating_penalties:increase", function(e) {
	var prefix = (e.sourceAttribute).slice(0,-8); // Strips off the 'increase'
	var id = `${prefix}value`;
	log(prefix);
	getAttrs([id], function(a) {
		log(a);
		var value = a[id];
		if ( typeof value !== "undefined" && Number(value) > 0 ) {
			value = Number(value) + 1;
			var s = {};
			s[id] = value;
			setAttrs(s);
		} else {
			log("will not increase");
			log(Number(value));
		}
	});
});

on("clicked:edit_powers clicked:edit_qualities clicked:edit_status clicked:edit_health clicked:edit_penalties clicked:edit_bonuses clicked:edit_principles clicked:edit_modes clicked:edit_minions clicked:edit_abilities_green clicked:edit_abilities_yellow clicked:edit_abilities_red clicked:edit_abilities_out clicked:repeating_abilitiesgreen:actionicona clicked:repeating_abilitiesgreen:actioniconb clicked:repeating_abilitiesgreen:actioniconh clicked:repeating_abilitiesgreen:actionicono clicked:repeating_abilitiesgreen:actionicond clicked:repeating_abilitiesgreen:actioniconr clicked:repeating_abilitiesyellow:actionicona clicked:repeating_abilitiesyellow:actioniconb clicked:repeating_abilitiesyellow:actioniconh clicked:repeating_abilitiesyellow:actionicono clicked:repeating_abilitiesyellow:actionicond clicked:repeating_abilitiesyellow:actioniconr clicked:repeating_abilitiesred:actionicona clicked:repeating_abilitiesred:actioniconb clicked:repeating_abilitiesred:actioniconh clicked:repeating_abilitiesred:actionicono clicked:repeating_abilitiesred:actionicond clicked:repeating_abilitiesred:actioniconr clicked:repeating_abilitiesout:actionicona clicked:repeating_abilitiesout:actioniconb clicked:repeating_abilitiesout:actioniconh clicked:repeating_abilitiesout:actionicono clicked:repeating_abilitiesout:actionicond clicked:repeating_abilitiesout:actioniconr", function(e) {
	log(e);
	var id = "";
	if ( typeof e.sourceAttribute !== "undefined" && e.sourceAttribute !== "" ) {
		id = e.sourceAttribute;
	} else {
		id = (e.htmlAttributes.name).substring(4); // Strips off the 'act_'
	}
	log("Toggle Handler: " + id);
	getAttrs([id], function(a) {
		if ( a[id] === "1" ) {
			a[id] = "0";
		} else {
			a[id] = "1";
		}
		log(a);
		setAttrs(a);
	});
});

on("change:hpr1a change:hpr1b change:hpr1c change:hpr1d change:hpr2a change:hpr2b change:hpr2c change:hpr2d change:hpr3a change:hpr3b change:hpr3c change:hpr3d change:hpr4a change:hpr4b change:hpr4c change:hpr4d", function(e) {
	log(e);
	var id = e.sourceAttribute;
	var value = e.newValue;

	getSectionIDs("bonuses", function(b) {
		var bfields = [];
		for(var i=0; i < b.length; i++ ) {
			bfields[i] = "repeating_bonuses_" + b[i] + "_hpf";
		}
		getAttrs(bfields, function(a) {
			var matchid = ""; var bindex = 0;
			for(var i=0; i < bfields.length; i++ ) {
				bfid = bfields[i];
				if ( a[bfid] == id ) {
					matchid = bfid;
					bindex = i;
				}
			}
			if ( matchid === "" ) {
				// then there is NO established bonus record tied to the 
				// hero point bonus field that was clicked
				if ( value !== "0" ) {
					// then a bonus record should be created tied to the
					// hero point bonus field that was clicked
					var ba = {};
					var nid = generateActuallyUniqueRowID();
					var np = "repeating_bonuses_"+nid+"_";
					ba[np+"hpf"] = id;
					ba[np+"persistent"] = 0;
					ba[np+"exclusive"] = 0;
					ba[np+"tag"] = "hero point reward";
					ba[np+"value"] = value;
					setAttrs(ba);
				}
			} else {
				// then there IS an established bonus record tied to the
				// hero point bonus field that was clicked
				if ( value == "0" ) {
					// then the existing bonus record should be removed,
					// because the field that was clicked was set to unmarked
					removeRepeatingRow("repeating_bonuses_"+b[bindex]);
				}
			}
		});
	});
});

</script>

<rolltemplate class="sheet-rolltemplate-3pool">
	<div>
		{{name}}
	</div>
	<div>
		<div>d{{powerdie}} {{powername}} = {{powerresult}}</div>
		<div>d{{qualitydie}} {{qualityname}} = {{qualityresult}}</div>
		<div>d{{statusdie}} {{statusname}} = {{statusresult}}</div>
	</div>
	<div>
		<div>
			Min: {{min}}
			Mid: {{mid}}
			Max: {{max}}
		</div>
	</div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-simple">
	<div>
		{{name}}
	</div>
	<div>
		<div>d{{die}} {{diename}} = {{dieresult}}</div>
	</div>
</rolltemplate>

<input type="hidden" name="attr_sheet-version" value="1.0">
<div class="sheet-whole">

<input type="hidden" name="attr_selected_die_pool_text" value="">
<input type="hidden" name="attr_selected_die_status_text" value="">
<input type="hidden" name="attr_selected_die_power_text" value="">
<input type="hidden" name="attr_selected_die_quality_text" value="">
<input type="hidden" name="attr_selected_die_status" value="">
<input type="hidden" name="attr_selected_die_power" value="">
<input type="hidden" name="attr_selected_die_quality" value="">

<div>
<input type="text" name="attr_character_name" value="" class="sheet-bigname">
</div>

<div class="sheet-dicecols">

	<div class="sheet-dicecol-unadorned">

		<div class="sheet-dicecols">

			<div class="sheet-dicecol">
				<div class="sheet-dicecol-head">Rolls</div>
				<div class="sheet-rollcols">
					<div class="sheet-rollblock">
						<span name="attr_selected_die_pool_text"></span>
						<button type="action" name="act_roll3pool">
							<input type="hidden" name="attr_selected_die_power" value="" class="sheet-inlinedie"><span class="sheet-diepic"></span>
							<input type="hidden" name="attr_selected_die_quality" value="" class="sheet-inlinedie"><span class="sheet-diepic"></span>
							<input type="hidden" name="attr_selected_die_status" value="" class="sheet-inlinedie"><span class="sheet-diepic"></span>
						</button>
					</div>
					<div class="sheet-rollblock">
						<span name="attr_selected_die_power_text"></span>
						<button type="action" value="power" name="act_rolldie">
							<input type="hidden" name="attr_selected_die_power" value="" class="sheet-inlinedie"><span class="sheet-diepic"></span>
						</button>
					</div>
					<div class="sheet-rollblock">
						<span name="attr_selected_die_quality_text"></span>
						<button type="action" value="quality" name="act_rolldie">
							<input type="hidden" name="attr_selected_die_quality" value="" class="sheet-inlinedie"><span class="sheet-diepic"></span>
						</button>
					</div>
					<div class="sheet-rollblock">
						<span name="attr_selected_die_status_text"></span>
						<button type="action" value="status" name="act_rolldie">
							<input type="hidden" name="attr_selected_die_status" value="" class="sheet-inlinedie"><span class="sheet-diepic"></span>
						</button>
					</div>
				</div>
				<div class="sheet-rollcols">
					<div class="sheet-rollblock">
						<span>Individual Dice</span>
						<div>
							<button type="action" value="4" name="act_rolldie">
								<input type="hidden" value="4" class="sheet-inlinedie"><span class="sheet-diepic"></span>
							</button>
							<button type="action" value="6" name="act_rolldie">
								<input type="hidden" value="6" class="sheet-inlinedie"><span class="sheet-diepic"></span>
							</button>
							<button type="action" value="8" name="act_rolldie">
								<input type="hidden" value="8" class="sheet-inlinedie"><span class="sheet-diepic"></span>
							</button>
							<button type="action" value="10" name="act_rolldie">
								<input type="hidden" value="10" class="sheet-inlinedie"><span class="sheet-diepic"></span>
							</button>
							<button type="action" value="12" name="act_rolldie">
								<input type="hidden" value="12" class="sheet-inlinedie"><span class="sheet-diepic"></span>
							</button>
						</div>
					</div>
				</div>
			</div>

		</div>


		<div class="sheet-dicecols">

			<input type="hidden" name="attr_edit_powers" value="0" class="sheet-hide-on-one">
			<div class="sheet-dicecol sheet-halfsies">
				<div class="sheet-dicecol-head sheet-lefty">
					<button type="action" name="act_edit_powers" class="sheet-button-header-edit"></button>
					Powers
				</div>
				<fieldset class="repeating_heropowers">
					<input type="hidden" name="attr_name" value="">
					<div class="sheet-dicerow">
						<input type="hidden" name="attr_hero_die_selector" value="" class="sheet-dieselected">
						<input type="hidden" name="attr_die" value="" class="sheet-dieval">
						<div class="sheet-die">
							<input type="checkbox" name="attr_hero_die_selector" value="1" class="sheet-dieboxer">
							<div class="sheet-diepic"></div>
						</div>
						<div class="sheet-dielabel">
							<span name="attr_name"></span>
						</div>
					</div>
				</fieldset>
			</div>

			<input type="hidden" name="attr_edit_powers" value="0" class="sheet-hide-on-zero">
			<div class="sheet-dicecol sheet-editcol sheet-halfsies">
				<div class="sheet-dicecol-head sheet-lefty">
					<button type="action" name="act_edit_powers" class="sheet-button-header-close"></button>
					Powers
				</div>
				<fieldset class="repeating_heropowers">
					<input type="hidden" name="attr_name" value="">
					<div class="sheet-dicerow">
						<input type="hidden" name="attr_hero_die_selector" value="">
						<select name="attr_die">
							<option value="">[Choose]</option>
							<option value="12">d12</option>
							<option value="10">d10</option>
							<option value="8">d8</option>
							<option value="6">d6</option>
							<option value="4">d4</option>
						</select>
						<input type="text" name="attr_name" value="">
					</div>
				</fieldset>
			</div>

			<input type="hidden" name="attr_edit_qualities" value="0" class="sheet-hide-on-one">
			<div class="sheet-dicecol sheet-halfsies">
				<div class="sheet-dicecol-head sheet-lefty">
					<button type="action" name="act_edit_qualities" class="sheet-button-header-edit"></button>
					Qualities
				</div>
				<fieldset class="repeating_heroqualities">
					<input type="hidden" name="attr_name" value="">
					<div class="sheet-dicerow">
						<input type="hidden" name="attr_hero_die_selector" value="" class="sheet-dieselected">
						<input type="hidden" name="attr_die" value="" class="sheet-dieval">
						<div class="sheet-die">
							<input type="checkbox" name="attr_hero_die_selector" value="1" class="sheet-dieboxer">
							<div class="sheet-diepic"></div>
						</div>
						<div class="sheet-dielabel">
							<span name="attr_name"></span>
						</div>
					</div>
				</fieldset>
			</div>
				
			<input type="hidden" name="attr_edit_qualities" value="0" class="sheet-hide-on-zero">
			<div class="sheet-dicecol sheet-editcol sheet-halfsies">
				<div class="sheet-dicecol-head sheet-lefty">
					<button type="action" name="act_edit_qualities" class="sheet-button-header-close"></button>
					Qualities
				</div>
				<fieldset class="repeating_heroqualities">
					<input type="hidden" name="attr_name" value="">
					<div class="sheet-dicerow">
						<input type="hidden" name="attr_hero_die_selector" value="">
						<select name="attr_die">
							<option value="">[Choose]</option>
							<option value="12">d12</option>
							<option value="10">d10</option>
							<option value="8">d8</option>
							<option value="6">d6</option>
							<option value="4">d4</option>
						</select>
						<input type="text" name="attr_name" value="">
					</div>
				</fieldset>
			</div>
			
			<input type="hidden" name="attr_edit_status" value="0" class="sheet-hide-on-one">
			<div class="sheet-dicecol sheet-noflexgrow">
				<div class="sheet-dicecol-head sheet-lefty">
					<button type="action" name="act_edit_status" class="sheet-button-header-edit"></button>
					Status
				</div>
				<div class="sheet-dicerow">
					<input type="hidden" name="attr_hero_die_selector_status_green" value="" class="sheet-dieselected">
					<input type="hidden" name="attr_hero_status_die_green" value="8" class="sheet-dieval">
					<div class="sheet-die">
						<input type="checkbox" name="attr_hero_die_selector_status_green" value="1" class="sheet-dieboxer">
						<div class="sheet-diepic"></div>
					</div>
					<div class="sheet-dielabel sheet-status-green">
						Green
					</div>
				</div>
				<div class="sheet-dicerow">
					<input type="hidden" name="attr_hero_die_selector_status_yellow" value="" class="sheet-dieselected">
					<input type="hidden" name="attr_hero_status_die_yellow" value="8" class="sheet-dieval">
					<div class="sheet-die">
						<input type="checkbox" name="attr_hero_die_selector_status_yellow" value="1" class="sheet-dieboxer">
						<div class="sheet-diepic"></div>
					</div>
					<div class="sheet-dielabel sheet-status-yellow">
						Yellow
					</div>
				</div>
				<div class="sheet-dicerow">
					<input type="hidden" name="attr_hero_die_selector_status_red" value="" class="sheet-dieselected">
					<input type="hidden" name="attr_hero_status_die_red" value="8" class="sheet-dieval">
					<div class="sheet-die">
						<input type="checkbox" name="attr_hero_die_selector_status_red" value="1" class="sheet-dieboxer">
						<div class="sheet-diepic"></div>
					</div>
					<div class="sheet-dielabel sheet-status-red">
						Red
					</div>
				</div>
				<div class="sheet-smalldata-row sheet-padding">
					<div class="sheet-smalldata sheet-centered">
						<span>Current Scene Status</span>
						<select name="attr_scene_status" class="sheet-120">
							<option value="green" selected>Green</option>
							<option value="yellow">Yellow</option>
							<option value="red">Red</option>
						</select>
					</div>
				</div>
			</div>

			<input type="hidden" name="attr_edit_status" value="0" class="sheet-hide-on-zero">
			<div class="sheet-dicecol sheet-editcol">
				<div class="sheet-dicecol-head sheet-lefty">
					<button type="action" name="act_edit_status" class="sheet-button-header-close"></button>
					Status
				</div>
				<div class="sheet-dicerow">
					<input type="hidden" name="attr_hero_status_die_green" value="">
					<select name="attr_hero_status_die_green">
						<option value="">[Choose]</option>
						<option value="12">d12</option>
						<option value="10">d10</option>
						<option value="8">d8</option>
						<option value="6">d6</option>
						<option value="4">d4</option>
					</select>
					<div class="sheet-dielabel sheet-status-green">Green</div>
				</div>
				<div class="sheet-dicerow">
					<input type="hidden" name="attr_hero_status_die_yellow" value="">
					<select name="attr_hero_status_die_yellow">
						<option value="">[Choose]</option>
						<option value="12">d12</option>
						<option value="10">d10</option>
						<option value="8">d8</option>
						<option value="6">d6</option>
						<option value="4">d4</option>
					</select>
					<div class="sheet-dielabel sheet-status-yellow">Yellow</div>
				</div>
				<div class="sheet-dicerow">
					<input type="hidden" name="attr_hero_status_die_red" value="">
					<select name="attr_hero_status_die_red">
						<option value="">[Choose]</option>
						<option value="12">d12</option>
						<option value="10">d10</option>
						<option value="8">d8</option>
						<option value="6">d6</option>
						<option value="4">d4</option>
					</select>
					<div class="sheet-dielabel sheet-status-red">Red</div>
				</div>
			</div>

		</div>

	</div>

	<div class="sheet-dicecol sheet-noflexgrow sheet-centered sheet-healthbox">
		<div class="sheet-dicecol-head sheet-lefty">
			<input type="hidden" name="attr_edit_health" value="1" class="sheet-hide-on-zero"><button type="action" name="act_edit_health" class="sheet-button-header-close"></button>
			<input type="hidden" name="attr_edit_health" value="1" class="sheet-hide-on-one"><button type="action" name="act_edit_health" class="sheet-button-header-edit"></button>
			Health
		</div>
		<div class="sheet-centered">

			<input type="hidden" name="attr_edit_health" value="1" class="sheet-hide-on-zero">
			<div class="sheet-smalldata-row sheet-padding">
				<div class="sheet-smalldata sheet-centered">
					<input type="number" name="attr_health_max" value="17" min="0">
					<span>Max Health</span>
				</div>
			</div>

			<div class="sheet-centered">
				<input type="hidden" name="attr_healthcolor" value="green" class="sheet-colorizer">
				<input type="number" name="attr_health" value="17" min="0" class="sheet-bignum">
			</div>
		</div>
		<div class="sheet-smalldata-row sheet-padding">
			<div class="sheet-smalldata sheet-centered">
				<input type="hidden" value="green" class="sheet-colorizer"><span>Green</span>
				<span>
				</span>
				<span class="sheet-pow-green">
					<input type="hidden" name="attr_health_max" value="17">
					<input type="hidden" name="attr_health_green_bottom" value="14">
					<span name="attr_health_max"></span>-<span name="attr_health_green_bottom"></span>
				</span>
			</div>
		</div>
		<div class="sheet-smalldata-row sheet-padding">
			<div class="sheet-smalldata sheet-centered">
				<input type="hidden" value="yellow" class="sheet-colorizer"><span>Yellow</span>
				<span class="sheet-pow-yellow"><input type="hidden" name="attr_health_yellow_top" value="13">
					<input type="hidden" name="attr_health_yellow_bottom" value="7">
					<span name="attr_health_yellow_top"></span>-<span name="attr_health_yellow_bottom"></span>
				</span>
			</div>
		</div>
		<div class="sheet-smalldata-row sheet-padding">
			<div class="sheet-smalldata sheet-centered">
				<input type="hidden" value="red" class="sheet-colorizer"><span>Red</span>
				<span class="sheet-pow-red"><input type="hidden" name="attr_health_red_top" value="6">
					<span name="attr_health_red_top"></span>-1
				</span>
			</div>
		</div>
	</div>
	
</div>

<div class="sheet-dicecols">

	<div class="sheet-dicecol sheet-halfsies">
		<div class="sheet-dicecol-head sheet-lefty">
			<input type="hidden" name="attr_edit_bonuses" value="0" class="sheet-hide-on-zero"><button type="action" name="act_edit_bonuses" class="sheet-button-header-close"></button>
			<input type="hidden" name="attr_edit_bonuses" value="0" class="sheet-hide-on-one"><button type="action" name="act_edit_bonuses" class="sheet-button-header-edit"></button>
			Bonuses
		</div>
		<div class="sheet-padding">
			<input type="hidden" name="attr_edit_bonuses" value="0" class="sheet-hide-on-zero">
			<div class="sheet-modline">
				<button type="action" value="12" name="act_addbonus">Add</button>
				<select name="attr_addbonus_value">
					<option value="1">+1 (on a 1-3)</option>
					<option value="2">+2 (on a 4-7)</option>
					<option value="3">+3 (on a 8-11)</option>
					<option value="4">+4 (on a 12+)</option>
				</select>
				<span><input type="checkbox" value="1" class="sheet-oval-marker" name="attr_addbonus_persistent"><span class="sheet-oval-icon"></span>&nbsp;Persistent</span>
				<span><input type="checkbox" value="1" class="sheet-oval-marker" name="attr_addbonus_exclusive"><span class="sheet-oval-icon"></span>&nbsp;Exclusive</span>
				<input type="text" name="attr_addbonus_tag" class="sheet-noflexgrow">
			</div>
		</div>
		<div class="sheet-padding sheet-modgrid">
			<fieldset class="repeating_bonuses">
				<input type="hidden" name="attr_value" value="1">
				<input type="hidden" name="attr_tag" value="">
				<input type="hidden" name="attr_hpf" value="">
				<div class="sheet-modifier">
					<div class="sheet-centered sheet-modnum">
						+<span name="attr_value"></span>
					</div>
					<div class="sheet-smalldata sheet-centered">
						<input type="hidden" name="attr_persistent" value="1" class="sheet-hide-on-zero"><span>persistent</span>
						<input type="hidden" name="attr_exclusive" value="1" class="sheet-hide-on-zero"><span>exclusive</span>
						<span name="attr_tag"></span>
						<div class="sheet-modcontrol sheet-centered">
							<button type="action" name="act_increase" class="sheet-button-increase"></button>
							<input type="hidden" name="attr_value" class="sheet-hide-on-one"><button type="action" name="act_decrease" class="sheet-button-decrease"></button>
							<button type="action" name="act_dismiss" class="sheet-button-delete"></button>
						</div>
					</div>
				</div>
			</fieldset>
		</div>
	</div>
	<div class="sheet-dicecol sheet-halfsies">
		<div class="sheet-dicecol-head sheet-lefty">
			<input type="hidden" name="attr_edit_penalties" value="0" class="sheet-hide-on-zero"><button type="action" name="act_edit_penalties" class="sheet-button-header-close"></button>
			<input type="hidden" name="attr_edit_penalties" value="0" class="sheet-hide-on-one"><button type="action" name="act_edit_penalties" class="sheet-button-header-edit"></button>
			Penalties
		</div>
		<div class="sheet-padding">
			<input type="hidden" name="attr_edit_penalties" value="0" class="sheet-hide-on-zero">
			<div class="sheet-modline">
				<button type="action" value="12" name="act_addpenalty">Add</button>
				<select name="attr_addpenalty_value">
					<option value="1">-1 (on a 1-3)</option>
					<option value="2">-2 (on a 4-7)</option>
					<option value="3">-3 (on a 8-11)</option>
					<option value="4">-4 (on a 12+)</option>
				</select>
				<span><input type="checkbox" value="1" class="sheet-oval-marker" name="attr_addpenalty_persistent"><span class="sheet-oval-icon"></span>&nbsp;Persistent</span>
				<span><input type="checkbox" value="1" class="sheet-oval-marker" name="attr_addpenalty_exclusive"><span class="sheet-oval-icon"></span>&nbsp;Exclusive</span>
				<input type="text" name="attr_addpenalty_tag" class="sheet-noflexgrow">
			</div>
		</div>
		<div class="sheet-padding sheet-modgrid">
			<fieldset class="repeating_penalties">
				<input type="hidden" name="attr_value" value="1">
				<input type="hidden" name="attr_tag" value="">
				<div class="sheet-modifier">
					<div class="sheet-centered sheet-modnum">
						-<span name="attr_value"></span>
					</div>
					<div class="sheet-smalldata sheet-centered">
						<input type="hidden" name="attr_persistent" value="0" class="sheet-hide-on-zero"><span>persistent</span>
						<input type="hidden" name="attr_exclusive" value="0" class="sheet-hide-on-zero"><span>exclusive</span>
						<span name="attr_tag"></span>
						<div class="sheet-modcontrol sheet-centered">
							<button type="action" name="act_increase" class="sheet-button-increase"></button>
							<input type="hidden" name="attr_value" class="sheet-hide-on-one"><button type="action" name="act_decrease" class="sheet-button-decrease"></button>
							<button type="action" name="act_dismiss" class="sheet-button-delete"></button>
						</div>
					</div>
				</div>
			</fieldset>
		</div>
	</div>

</div>

<div class="sheet-dicecols">

	<div class="sheet-dicecol sheet-halfsies">
		<div class="sheet-dicecol-head sheet-lefty">
			<input type="hidden" name="attr_edit_modes" value="0" class="sheet-hide-on-zero"><button type="action" name="act_edit_modes" class="sheet-button-header-close"></button>
			<input type="hidden" name="attr_edit_modes" value="0" class="sheet-hide-on-one"><button type="action" name="act_edit_modes" class="sheet-button-header-edit"></button>
			Modes/Forms
		</div>
		<div>
			Use JSON stringify to store existing die pool configurations.
			Figure out how to preserve selected things if possible (maybe edit existing named things rather than delete them).
			Give each mode a name, a description (this can be where descriptions, but also rules restrictions, live).
			Store JSON stringified snapshot.
			Give Abilities a field where they can specify that the ability is only available for the currently active mode.
		</div>
	</div>

	<div class="sheet-dicecol sheet-halfsies">
		<div class="sheet-dicecol-head sheet-lefty">
			<input type="hidden" name="attr_edit_minions" value="0" class="sheet-hide-on-zero"><button type="action" name="act_edit_minions" class="sheet-button-header-close"></button>
			<input type="hidden" name="attr_edit_minions" value="0" class="sheet-hide-on-one"><button type="action" name="act_edit_minions" class="sheet-button-header-edit"></button>
			Minions
		</div>
	</div>

</div>

<div class="sheet-abilities">

	<div class="sheet-abilities-green">
		<div class="sheet-abilities-head sheet-lefty">
			<input type="hidden" name="attr_edit_abilities_green" value="1" class="sheet-hide-on-zero"><button type="action" name="act_edit_abilities_green" class="sheet-button-header-close"></button>
			<input type="hidden" name="attr_edit_abilities_green" value="1" class="sheet-hide-on-one"><button type="action" name="act_edit_abilities_green" class="sheet-button-header-edit"></button>
			Green Abilities
		</div>
		<input type="hidden" name="attr_edit_abilities_green" value="1" class="sheet-hide-on-one">
		<div><fieldset class="repeating_abilitiesgreen">
			<div class="sheet-abilities-row">
				<input type="hidden" name="attr_actionicona" value="">
				<input type="hidden" name="attr_actioniconb" value="">
				<input type="hidden" name="attr_actioniconh" value="">
				<input type="hidden" name="attr_actionicono" value="">
				<input type="hidden" name="attr_actionicond" value="">
				<input type="hidden" name="attr_actioniconr" value="">
				<input type="hidden" name="attr_action_type" value="">
				<input type="hidden" name="attr_action_name" value="">
				<input type="hidden" name="attr_action_description" value="">
				<div class="sheet-ability-icons">
					<input type="hidden" name="attr_actionicona" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-a"></span>
					<input type="hidden" name="attr_actioniconb" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-b"></span>
					<input type="hidden" name="attr_actioniconh" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-h"></span>
					<input type="hidden" name="attr_actionicono" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-o"></span>
					<input type="hidden" name="attr_actionicond" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-d"></span>
					<input type="hidden" name="attr_actioniconr" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-r"></span>
				</div>
				<div class="sheet-ability-type">
					<span name="attr_action_type"></span>
				</div>
				<div class="sheet-ability-description">
					<b><span name="attr_action_name"></span>:</b>
					<span name="attr_action_description"></span>
				</div>
			</div>
		</fieldset></div>
		<input type="hidden" name="attr_edit_abilities_green" value="1" class="sheet-hide-on-zero">
		<div class="sheet-editcol"><fieldset class="repeating_abilitiesgreen">
			<div class="sheet-abilities-row">
				<input type="hidden" name="attr_action_type" value="">
				<input type="hidden" name="attr_action_name" value="">
				<input type="hidden" name="attr_action_description" value="">
				<div class="sheet-ability-icons">

					<input type="hidden" name="attr_actionicona" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actionicona" class="sheet-buttonless sheet-icon-button" value="actionicona"><span class="sheet-action-icon-a"></span></button></span>
					<input type="hidden" name="attr_actioniconb" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actioniconb" class="sheet-buttonless sheet-icon-button" value="actioniconb"><span class="sheet-action-icon-b"></span></button></span>
					<input type="hidden" name="attr_actioniconh" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actioniconh" class="sheet-buttonless sheet-icon-button" value="actioniconh"><span class="sheet-action-icon-h"></span></button></span>
					<input type="hidden" name="attr_actionicono" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actionicono" class="sheet-buttonless sheet-icon-button" value="actionicono"><span class="sheet-action-icon-o"></span></button></span>
					<input type="hidden" name="attr_actionicond" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actionicond" class="sheet-buttonless sheet-icon-button" value="actionicond"><span class="sheet-action-icon-d"></span></button></span>
					<input type="hidden" name="attr_actioniconr" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actioniconr" class="sheet-buttonless sheet-icon-button" value="actioniconr"><span class="sheet-action-icon-r"></span></button></span>

				</div>
				<div class="sheet-ability-type">
					<select name="attr_action_type">
						<option value="">[Choose]</option>
						<option value="A">Action</option>
						<option value="I">Inherent</option>
						<option value="R">Reaction</option>
					</select>
				</div>
				<div class="sheet-ability-description">
					<b><input type="text" name="attr_action_name" value="">:</b>
					<textarea name="attr_action_description"></textarea>
				</div>
			</div>
		</fieldset></div>
	</div>

	<div class="sheet-abilities-yellow">
		<div class="sheet-abilities-head sheet-lefty">
			<input type="hidden" name="attr_edit_abilities_yellow" value="1" class="sheet-hide-on-zero"><button type="action" name="act_edit_abilities_yellow" class="sheet-button-header-close"></button>
			<input type="hidden" name="attr_edit_abilities_yellow" value="1" class="sheet-hide-on-one"><button type="action" name="act_edit_abilities_yellow" class="sheet-button-header-edit"></button>
			Yellow Abilities
		</div>
		<input type="hidden" name="attr_edit_abilities_yellow" value="1" class="sheet-hide-on-one">
		<div><fieldset class="repeating_abilitiesyellow">
			<div class="sheet-abilities-row">
				<input type="hidden" name="attr_actionicona" value="">
				<input type="hidden" name="attr_actioniconb" value="">
				<input type="hidden" name="attr_actioniconh" value="">
				<input type="hidden" name="attr_actionicono" value="">
				<input type="hidden" name="attr_actionicond" value="">
				<input type="hidden" name="attr_actioniconr" value="">
				<input type="hidden" name="attr_action_type" value="">
				<input type="hidden" name="attr_action_name" value="">
				<input type="hidden" name="attr_action_description" value="">
				<div class="sheet-ability-icons">
					<input type="hidden" name="attr_actionicona" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-a"></span>
					<input type="hidden" name="attr_actioniconb" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-b"></span>
					<input type="hidden" name="attr_actioniconh" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-h"></span>
					<input type="hidden" name="attr_actionicono" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-o"></span>
					<input type="hidden" name="attr_actionicond" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-d"></span>
					<input type="hidden" name="attr_actioniconr" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-r"></span>
				</div>
				<div class="sheet-ability-type">
					<span name="attr_action_type"></span>
				</div>
				<div class="sheet-ability-description">
					<b><span name="attr_action_name"></span>:</b>
					<span name="attr_action_description"></span>
				</div>
			</div>
		</fieldset></div>
		<input type="hidden" name="attr_edit_abilities_yellow" value="1" class="sheet-hide-on-zero">
		<div class="sheet-editcol"><fieldset class="repeating_abilitiesyellow">
			<div class="sheet-abilities-row">
				<input type="hidden" name="attr_action_type" value="">
				<input type="hidden" name="attr_action_name" value="">
				<input type="hidden" name="attr_action_description" value="">
				<div class="sheet-ability-icons">

					<input type="hidden" name="attr_actionicona" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actionicona" class="sheet-buttonless sheet-icon-button" value="actionicona"><span class="sheet-action-icon-a"></span></button></span>
					<input type="hidden" name="attr_actioniconb" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actioniconb" class="sheet-buttonless sheet-icon-button" value="actioniconb"><span class="sheet-action-icon-b"></span></button></span>
					<input type="hidden" name="attr_actioniconh" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actioniconh" class="sheet-buttonless sheet-icon-button" value="actioniconh"><span class="sheet-action-icon-h"></span></button></span>
					<input type="hidden" name="attr_actionicono" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actionicono" class="sheet-buttonless sheet-icon-button" value="actionicono"><span class="sheet-action-icon-o"></span></button></span>
					<input type="hidden" name="attr_actionicond" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actionicond" class="sheet-buttonless sheet-icon-button" value="actionicond"><span class="sheet-action-icon-d"></span></button></span>
					<input type="hidden" name="attr_actioniconr" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actioniconr" class="sheet-buttonless sheet-icon-button" value="actioniconr"><span class="sheet-action-icon-r"></span></button></span>

				</div>
				<div class="sheet-ability-type">
					<select name="attr_action_type">
						<option value="">[Choose]</option>
						<option value="A">Action</option>
						<option value="I">Inherent</option>
						<option value="R">Reaction</option>
					</select>
				</div>
				<div class="sheet-ability-description">
					<b><input type="text" name="attr_action_name" value="">:</b>
					<textarea name="attr_action_description"></textarea>
				</div>
			</div>
		</fieldset></div>
	</div>

	<div class="sheet-abilities-red">
		<div class="sheet-abilities-head sheet-lefty">
			<input type="hidden" name="attr_edit_abilities_red" value="1" class="sheet-hide-on-zero"><button type="action" name="act_edit_abilities_red" class="sheet-button-header-close"></button>
			<input type="hidden" name="attr_edit_abilities_red" value="1" class="sheet-hide-on-one"><button type="action" name="act_edit_abilities_red" class="sheet-button-header-edit"></button>
			Red Abilities
		</div>
		<input type="hidden" name="attr_edit_abilities_red" value="1" class="sheet-hide-on-one">
		<div><fieldset class="repeating_abilitiesred">
			<div class="sheet-abilities-row">
				<input type="hidden" name="attr_actionicona" value="">
				<input type="hidden" name="attr_actioniconb" value="">
				<input type="hidden" name="attr_actioniconh" value="">
				<input type="hidden" name="attr_actionicono" value="">
				<input type="hidden" name="attr_actionicond" value="">
				<input type="hidden" name="attr_actioniconr" value="">
				<input type="hidden" name="attr_action_type" value="">
				<input type="hidden" name="attr_action_name" value="">
				<input type="hidden" name="attr_action_description" value="">
				<div class="sheet-ability-icons">
					<input type="hidden" name="attr_actionicona" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-a"></span>
					<input type="hidden" name="attr_actioniconb" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-b"></span>
					<input type="hidden" name="attr_actioniconh" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-h"></span>
					<input type="hidden" name="attr_actionicono" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-o"></span>
					<input type="hidden" name="attr_actionicond" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-d"></span>
					<input type="hidden" name="attr_actioniconr" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-r"></span>
				</div>
				<div class="sheet-ability-type">
					<span name="attr_action_type"></span>
				</div>
				<div class="sheet-ability-description">
					<b><span name="attr_action_name"></span>:</b>
					<span name="attr_action_description"></span>
				</div>
			</div>
		</fieldset></div>
		<input type="hidden" name="attr_edit_abilities_red" value="1" class="sheet-hide-on-zero">
		<div class="sheet-editcol"><fieldset class="repeating_abilitiesred">
			<div class="sheet-abilities-row">
				<input type="hidden" name="attr_action_type" value="">
				<input type="hidden" name="attr_action_name" value="">
				<input type="hidden" name="attr_action_description" value="">
				<div class="sheet-ability-icons">

					<input type="hidden" name="attr_actionicona" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actionicona" class="sheet-buttonless sheet-icon-button" value="actionicona"><span class="sheet-action-icon-a"></span></button></span>
					<input type="hidden" name="attr_actioniconb" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actioniconb" class="sheet-buttonless sheet-icon-button" value="actioniconb"><span class="sheet-action-icon-b"></span></button></span>
					<input type="hidden" name="attr_actioniconh" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actioniconh" class="sheet-buttonless sheet-icon-button" value="actioniconh"><span class="sheet-action-icon-h"></span></button></span>
					<input type="hidden" name="attr_actionicono" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actionicono" class="sheet-buttonless sheet-icon-button" value="actionicono"><span class="sheet-action-icon-o"></span></button></span>
					<input type="hidden" name="attr_actionicond" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actionicond" class="sheet-buttonless sheet-icon-button" value="actionicond"><span class="sheet-action-icon-d"></span></button></span>
					<input type="hidden" name="attr_actioniconr" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actioniconr" class="sheet-buttonless sheet-icon-button" value="actioniconr"><span class="sheet-action-icon-r"></span></button></span>

				</div>
				<div class="sheet-ability-type">
					<select name="attr_action_type">
						<option value="">[Choose]</option>
						<option value="A">Action</option>
						<option value="I">Inherent</option>
						<option value="R">Reaction</option>
					</select>
				</div>
				<div class="sheet-ability-description">
					<b><input type="text" name="attr_action_name" value="">:</b>
					<textarea name="attr_action_description"></textarea>
				</div>
			</div>
		</fieldset></div>
	</div>

	<div class="sheet-abilities-out">
		<div class="sheet-abilities-head sheet-lefty">
			<input type="hidden" name="attr_edit_abilities_out" value="1" class="sheet-hide-on-zero"><button type="action" name="act_edit_abilities_out" class="sheet-button-header-close"></button>
			<input type="hidden" name="attr_edit_abilities_out" value="1" class="sheet-hide-on-one"><button type="action" name="act_edit_abilities_out" class="sheet-button-header-edit"></button>
			Out Ability
		</div>
		<input type="hidden" name="attr_edit_abilities_out" value="1" class="sheet-hide-on-one">
		<div><fieldset class="repeating_abilitiesout">
			<div class="sheet-abilities-row">
				<input type="hidden" name="attr_actionicona" value="">
				<input type="hidden" name="attr_actioniconb" value="">
				<input type="hidden" name="attr_actioniconh" value="">
				<input type="hidden" name="attr_actionicono" value="">
				<input type="hidden" name="attr_actionicond" value="">
				<input type="hidden" name="attr_actioniconr" value="">
				<input type="hidden" name="attr_action_type" value="">
				<input type="hidden" name="attr_action_name" value="">
				<input type="hidden" name="attr_action_description" value="">
				<div class="sheet-ability-icons">
					<input type="hidden" name="attr_actionicona" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-a"></span>
					<input type="hidden" name="attr_actioniconb" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-b"></span>
					<input type="hidden" name="attr_actioniconh" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-h"></span>
					<input type="hidden" name="attr_actionicono" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-o"></span>
					<input type="hidden" name="attr_actionicond" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-d"></span>
					<input type="hidden" name="attr_actioniconr" value="0" class="sheet-hide-on-zero sheet-action-icon"><span class="sheet-action-icon-r"></span>
				</div>
				<div class="sheet-ability-type">
					<span name="attr_action_type"></span>
				</div>
				<div class="sheet-ability-description">
					<b><span name="attr_action_name"></span>:</b>
					<span name="attr_action_description"></span>
				</div>
			</div>
		</fieldset></div>
		<input type="hidden" name="attr_edit_abilities_out" value="1" class="sheet-hide-on-zero">
		<div class="sheet-editcol"><fieldset class="repeating_abilitiesout">
			<div class="sheet-abilities-row">
				<input type="hidden" name="attr_action_type" value="">
				<input type="hidden" name="attr_action_name" value="">
				<input type="hidden" name="attr_action_description" value="">
				<div class="sheet-ability-icons">

					<input type="hidden" name="attr_actionicona" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actionicona" class="sheet-buttonless sheet-icon-button" value="actionicona"><span class="sheet-action-icon-a"></span></button></span>
					<input type="hidden" name="attr_actioniconb" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actioniconb" class="sheet-buttonless sheet-icon-button" value="actioniconb"><span class="sheet-action-icon-b"></span></button></span>
					<input type="hidden" name="attr_actioniconh" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actioniconh" class="sheet-buttonless sheet-icon-button" value="actioniconh"><span class="sheet-action-icon-h"></span></button></span>
					<input type="hidden" name="attr_actionicono" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actionicono" class="sheet-buttonless sheet-icon-button" value="actionicono"><span class="sheet-action-icon-o"></span></button></span>
					<input type="hidden" name="attr_actionicond" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actionicond" class="sheet-buttonless sheet-icon-button" value="actionicond"><span class="sheet-action-icon-d"></span></button></span>
					<input type="hidden" name="attr_actioniconr" value="0" class="sheet-fade-on-zero"><span><button type="action" name="act_actioniconr" class="sheet-buttonless sheet-icon-button" value="actioniconr"><span class="sheet-action-icon-r"></span></button></span>

				</div>
				<div class="sheet-ability-type">
					<select name="attr_action_type">
						<option value="">[Choose]</option>
						<option value="A">Action</option>
						<option value="I">Inherent</option>
						<option value="R">Reaction</option>
					</select>
				</div>
				<div class="sheet-ability-description">
					<b><input type="text" name="attr_action_name" value="">:</b>
					<textarea name="attr_action_description"></textarea>
				</div>
			</div>
		</fieldset></div>
	</div>

</div>

<input type="hidden" name="attr_principle1_of" value="">
<input type="hidden" name="attr_principle1_rp" value="">
<input type="hidden" name="attr_principle1_twist_minor" value="">
<input type="hidden" name="attr_principle1_twist_major" value="">
<input type="hidden" name="attr_principle2_of" value="">
<input type="hidden" name="attr_principle2_rp" value="">
<input type="hidden" name="attr_principle2_twist_minor" value="">
<input type="hidden" name="attr_principle2_twist_major" value="">


<div class="sheet-dicecols">

	<div class="sheet-dicecol sheet-halfsies">
		<div class="sheet-dicecol-head sheet-lefty">
			<input type="hidden" name="attr_edit_principles" value="0" class="sheet-hide-on-zero"><button type="action" name="act_edit_principles" class="sheet-button-header-close"></button>
			<input type="hidden" name="attr_edit_principles" value="0" class="sheet-hide-on-one"><button type="action" name="act_edit_principles" class="sheet-button-header-edit"></button>
			Principle of 
			<input type="hidden" name="attr_edit_principles" value="0" class="sheet-hide-on-one"><span name="attr_principle1_of"></span>
			<input type="hidden" name="attr_edit_principles" value="0" class="sheet-hide-on-zero"><input type="text" name="attr_principle1_of"></span>
		</div>
		<div class="sheet-padding">
			<input type="hidden" name="attr_edit_principles" value="0" class="sheet-hide-on-zero"><b>During Roleplay:</b>
			<i>
				<input type="hidden" name="attr_edit_principles" value="0" class="sheet-hide-on-one"><span name="attr_principle1_rp"></span>
				<input type="hidden" name="attr_edit_principles" value="0" class="sheet-hide-on-zero"><textarea name="attr_principle1_rp" class="sheet-principle"></textarea>
			</i>
		</div>
		<div class="sheet-padding">
			<b>Minor Twist:</b> 
			<input type="hidden" name="attr_edit_principles" value="0" class="sheet-hide-on-one"><span name="attr_principle1_twist_minor"></span>
			<input type="hidden" name="attr_edit_principles" value="0" class="sheet-hide-on-zero"><textarea name="attr_principle1_twist_minor" class="sheet-principle"></textarea>
		</div>
		<div class="sheet-padding">
			<b>Major Twist:</b>
			<input type="hidden" name="attr_edit_principles" value="0" class="sheet-hide-on-one"><span name="attr_principle1_twist_major"></span>
			<input type="hidden" name="attr_edit_principles" value="0" class="sheet-hide-on-zero"><textarea name="attr_principle1_twist_major" class="sheet-principle"></textarea>
		</div>
	</div>

	<div class="sheet-dicecol sheet-halfsies">
		<div class="sheet-dicecol-head sheet-lefty">
			<input type="hidden" name="attr_edit_principles" value="0" class="sheet-hide-on-zero"><button type="action" name="act_edit_principles" class="sheet-button-header-close"></button>
			<input type="hidden" name="attr_edit_principles" value="0" class="sheet-hide-on-one"><button type="action" name="act_edit_principles" class="sheet-button-header-edit"></button>
			Principle of 
			<input type="hidden" name="attr_edit_principles" value="0" class="sheet-hide-on-one"><span name="attr_principle2_of"></span>
			<input type="hidden" name="attr_edit_principles" value="0" class="sheet-hide-on-zero"><input type="text" name="attr_principle2_of"></span>
		</div>
		<div class="sheet-padding">
			<input type="hidden" name="attr_edit_principles" value="0" class="sheet-hide-on-zero"><b>During Roleplay:</b>
			<i>
				<input type="hidden" name="attr_edit_principles" value="0" class="sheet-hide-on-one"><span name="attr_principle2_rp"></span>
				<input type="hidden" name="attr_edit_principles" value="0" class="sheet-hide-on-zero"><textarea name="attr_principle2_rp" class="sheet-principle"></textarea>
			</i>
		</div>
		<div class="sheet-padding">
			<b>Minor Twist:</b> 
			<input type="hidden" name="attr_edit_principles" value="0" class="sheet-hide-on-one"><span name="attr_principle2_twist_minor"></span>
			<input type="hidden" name="attr_edit_principles" value="0" class="sheet-hide-on-zero"><textarea name="attr_principle2_twist_minor" class="sheet-principle"></textarea>
		</div>
		<div class="sheet-padding">
			<b>Major Twist:</b>
			<input type="hidden" name="attr_edit_principles" value="0" class="sheet-hide-on-one"><span name="attr_principle2_twist_major"></span>
			<input type="hidden" name="attr_edit_principles" value="0" class="sheet-hide-on-zero"><textarea name="attr_principle2_twist_major" class="sheet-principle"></textarea>
		</div>
	</div>

</div>

<div class="sheet-dicecols">

	<div class="sheet-dicecol sheet-noflexgrow">
		<div class="sheet-dicecol-head">Hero Points</div>
		<div class="sheet-padding sheet-centered">
			<input type="checkbox" value="1" class="sheet-oval-marker" name="attr_shp1"><span class="sheet-oval-icon"></span>
			<input type="checkbox" value="1" class="sheet-oval-marker" name="attr_shp2"><span class="sheet-oval-icon"></span>
			<input type="checkbox" value="1" class="sheet-oval-marker" name="attr_shp3"><span class="sheet-oval-icon"></span>
			<input type="checkbox" value="1" class="sheet-oval-marker" name="attr_shp4"><span class="sheet-oval-icon"></span>
			<input type="checkbox" value="1" class="sheet-oval-marker" name="attr_shp5"><span class="sheet-oval-icon"></span>
		</div>
		<div class="sheet-dicecol-head">Rewards</div>
		<div class="sheet-padding">
			<div class="sheet-centered">
				<span class="sheet-inline-label">+1</span>
				<input type="checkbox" value="1" class="sheet-oval-marker" name="attr_hpr1a"><span class="sheet-oval-icon"></span>
				<input type="checkbox" value="1" class="sheet-oval-marker" name="attr_hpr1b"><span class="sheet-oval-icon"></span>
				<input type="checkbox" value="1" class="sheet-oval-marker" name="attr_hpr1c"><span class="sheet-oval-icon"></span>
				<input type="checkbox" value="1" class="sheet-oval-marker" name="attr_hpr1d"><span class="sheet-oval-icon"></span>
			</div>
			<div class="sheet-centered">
				<span class="sheet-inline-label">+2</span>
				<input type="checkbox" value="2" class="sheet-oval-marker" name="attr_hpr2a"><span class="sheet-oval-icon"></span>
				<input type="checkbox" value="2" class="sheet-oval-marker" name="attr_hpr2b"><span class="sheet-oval-icon"></span>
				<input type="checkbox" value="2" class="sheet-oval-marker" name="attr_hpr2c"><span class="sheet-oval-icon"></span>
				<input type="checkbox" value="2" class="sheet-oval-marker" name="attr_hpr2d"><span class="sheet-oval-icon"></span>
			</div>
			<div class="sheet-centered">
				<span class="sheet-inline-label">+3</span>
				<input type="checkbox" value="3" class="sheet-oval-marker" name="attr_hpr3a"><span class="sheet-oval-icon"></span>
				<input type="checkbox" value="3" class="sheet-oval-marker" name="attr_hpr3b"><span class="sheet-oval-icon"></span>
				<input type="checkbox" value="3" class="sheet-oval-marker" name="attr_hpr3c"><span class="sheet-oval-icon"></span>
				<input type="checkbox" value="3" class="sheet-oval-marker" name="attr_hpr3d"><span class="sheet-oval-icon"></span>
			</div>
			<div class="sheet-centered">
				<span class="sheet-inline-label">+4</span>
				<input type="checkbox" value="4" class="sheet-oval-marker" name="attr_hpr4a"><span class="sheet-oval-icon"></span>
				<input type="checkbox" value="4" class="sheet-oval-marker" name="attr_hpr4b"><span class="sheet-oval-icon"></span>
				<input type="checkbox" value="4" class="sheet-oval-marker" name="attr_hpr4c"><span class="sheet-oval-icon"></span>
				<input type="checkbox" value="4" class="sheet-oval-marker" name="attr_hpr4d"><span class="sheet-oval-icon"></span>
			</div>
		</div>
	</div>

	<div class="sheet-dicecol sheet-halfsies">
		<div class="sheet-dicecol-head">Back Issues</div>
		<div class="sheet-smalldata sheet-padding">
			<input type="text" name="attr_backissue1" value="">
			<input type="text" name="attr_backissue2" value="">
			<input type="text" name="attr_backissue3" value="">
			<input type="text" name="attr_backissue4" value="">
			<input type="text" name="attr_backissue5" value="">
			<input type="text" name="attr_backissue6" value="">
		</div>
	</div>

	<div class="sheet-dicecol sheet-halfsies">
		<div class="sheet-dicecol-head">Collections</div>
		<div class="sheet-padding">
			<div class="sheet-collection-row">
				<span>
					<input type="checkbox" value="used" class="sheet-oval-marker" name="attr_collection1_used"><span class="sheet-oval-icon"></span>
				</span>
				<input type="text" name="attr_collection1" value="">
			</div>
			<div class="sheet-collection-row">
				<span>
					<input type="checkbox" value="used" class="sheet-oval-marker" name="attr_collection2_used"><span class="sheet-oval-icon"></span>
				</span>
				<input type="text" name="attr_collection2" value="">
			</div>
			<div class="sheet-collection-row">
				<span>
					<input type="checkbox" value="used" class="sheet-oval-marker" name="attr_collection3_used"><span class="sheet-oval-icon"></span>
				</span>
				<input type="text" name="attr_collection3" value="">
			</div>
			<div class="sheet-collection-row">
				<span>
					<input type="checkbox" value="used" class="sheet-oval-marker" name="attr_collection4_used"><span class="sheet-oval-icon"></span>
				</span>
				<input type="text" name="attr_collection4" value="">
			</div>
			<div class="sheet-collection-row">
				<span>
					<input type="checkbox" value="used" class="sheet-oval-marker" name="attr_collection5_used"><span class="sheet-oval-icon"></span>
				</span>
				<input type="text" name="attr_collection5" value="">
			</div>
			<div class="sheet-collection-row">
				<span>
					<input type="checkbox" value="used" class="sheet-oval-marker" name="attr_collection6_used"><span class="sheet-oval-icon"></span>
				</span>
				<input type="text" name="attr_collection6" value="">
			</div>
		</div>
	</div>

</div>

<div class="sheet-dicecols">

	<div class="sheet-dicecol">
		<div class="sheet-dicecol-head">Personal Data</div>

		<div class="sheet-smalldata-row sheet-padding">
			<div class="sheet-smalldata">
				<input type="text" name="attr_character_alias" value="">
				<span>Alias</span>
			</div>
			<div class="sheet-smalldata">
				<input type="text" name="attr_character_costume" value="">
				<span>Costume/Equipment</span>
			</div>
		</div>
		<div class="sheet-smalldata-row sheet-padding">
			<div class="sheet-smalldata">
				<input type="text" name="attr_character_gender" value="">
				<span>Gender/Pronouns</span>
			</div>
			<div class="sheet-smalldata">
				<input type="text" name="attr_character_age" value="">
				<span>Age</span>
			</div>
			<div class="sheet-smalldata">
				<input type="text" name="attr_character_height" value="">
				<span>Height</span>
			</div>
			<div class="sheet-smalldata">
				<input type="text" name="attr_character_eyes" value="">
				<span>Eyes</span>
			</div>
			<div class="sheet-smalldata">
				<input type="text" name="attr_character_hair" value="">
				<span>Hair</span>
			</div>
			<div class="sheet-smalldata">
				<input type="text" name="attr_character_skin" value="">
				<span>Skin</span>
			</div>
			<div class="sheet-smalldata">
				<input type="text" name="attr_character_build" value="">
				<span>Build</span>
			</div>
		</div>
		<div class="sheet-smalldata-row sheet-padding">
			<div class="sheet-smalldata">
				<input type="text" name="attr_character_background" value="">
				<span>Background</span>
			</div>
			<div class="sheet-smalldata">
				<input type="text" name="attr_character_powersource" value="">
				<span>Power Source</span>
			</div>
			<div class="sheet-smalldata">
				<input type="text" name="attr_character_archetype" value="">
				<span>Archetype</span>
			</div>
			<div class="sheet-smalldata">
				<input type="text" name="attr_character_personality" value="">
				<span>Personality</span>
			</div>
		</div>

	</div>
	
</div>


</div> <!-- sheet-whole -->
